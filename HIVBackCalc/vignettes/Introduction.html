<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Jeanette Birnbaum and Martina Morris" />

<meta name="date" content="2015-03-26" />

<title>Introduction to HIVBackCalc</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">Introduction to HIVBackCalc</h1>
<h4 class="author"><em>Jeanette Birnbaum and Martina Morris</em></h4>
<h4 class="date"><em>2015-03-26</em></h4>
</div>


<p>HIVBackCalc estimates HIV incidence, and the number of undiagnosed HIV cases, from testing history data provided by diagnosed cases. The method is based on the basic principle of backcalculation: HIV diagnoses observed in a given year are the convolution of incidence in prior years and the probability of being diagnosed in the given year conditional on infection in a prior year. The package is desgined to be used with HIV surveillance data on the date of diagnosis, and the date of the last negative test for all diagnosed cases in a jurisdiction. Provision is made for cases diagnosed on their first test, and for cases with missing test history data.</p>
<p>This package contains the basic code needed to replicate the analysis in the corresponding paper. However, due to privacy regulations, the dataset included here is a simulated version that matches the population-level characteristics of the original data. The vignette will guide you through a full analysis, with a sensitivity analysis at the end.</p>
<div id="testing-history-data" class="section level2">
<h2>Testing History Data</h2>
<div id="overview" class="section level3">
<h3>Overview</h3>
<p>The example data embedded in the package approximate testing histories collected from HIV diagnoses among MSM in King County, Washington reported in 2006-2012. The following code will load the data into a data frame called <code>KCsim</code> and display the first 6 rows.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(KCsim)</code></pre>
<pre><code>## Warning: data set 'KCsim' not found</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(KCsim)</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">id</th>
<th align="left">Population</th>
<th align="left">mode</th>
<th align="left">race</th>
<th align="right">hdx_age</th>
<th align="left">agecat5</th>
<th align="right">yearDx</th>
<th align="right">timeDx</th>
<th align="left">everHadNegTest</th>
<th align="right">infPeriod</th>
<th align="left">everHadNegTestM</th>
<th align="right">infPeriodM</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">KC-sim</td>
<td align="left">MSM</td>
<td align="left">Hisp</td>
<td align="right">35</td>
<td align="left">31-35</td>
<td align="right">2011</td>
<td align="right">2011</td>
<td align="left">TRUE</td>
<td align="right">0.5315</td>
<td align="left">TRUE</td>
<td align="right">0.5315</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">KC-sim</td>
<td align="left">MSM</td>
<td align="left">White</td>
<td align="right">23</td>
<td align="left">21-25</td>
<td align="right">2008</td>
<td align="right">2009</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">KC-sim</td>
<td align="left">MSM</td>
<td align="left">Black</td>
<td align="right">36</td>
<td align="left">36-40</td>
<td align="right">2009</td>
<td align="right">2010</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">KC-sim</td>
<td align="left">MSM</td>
<td align="left">White</td>
<td align="right">32</td>
<td align="left">31-35</td>
<td align="right">2007</td>
<td align="right">2008</td>
<td align="left">TRUE</td>
<td align="right">10.2575</td>
<td align="left">FALSE</td>
<td align="right">16.0000</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">KC-sim</td>
<td align="left">MSM</td>
<td align="left">White</td>
<td align="right">36</td>
<td align="left">36-40</td>
<td align="right">2007</td>
<td align="right">2008</td>
<td align="left">FALSE</td>
<td align="right">18.0000</td>
<td align="left">FALSE</td>
<td align="right">18.0000</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">KC-sim</td>
<td align="left">MSM</td>
<td align="left">Black</td>
<td align="right">35</td>
<td align="left">31-35</td>
<td align="right">2008</td>
<td align="right">2008</td>
<td align="left">TRUE</td>
<td align="right">0.7671</td>
<td align="left">TRUE</td>
<td align="right">0.7671</td>
</tr>
</tbody>
</table>
<p>The necessary variables are:</p>
<ol style="list-style-type: decimal">
<li>Age at diagnosis (hdx_age)
<ul>
<li>In the simulated data set, hdx_age is reported in 5 yr intervals.</li>
</ul></li>
<li>Year of diagnosis (yearDx)</li>
<li>Time of diagnosis (timeDx)
<ul>
<li>Defined by the reporting time unit. In the example data, diagnoses are reported quarterly, specified using decimals: 0.00 = Q1 (Jan-Mar), 0.25 = Q2, etc. So someone diagnosed in the third quarter of 2008 would have timeDX = 2008.75.</li>
</ul></li>
<li>Testing history (everHadNegTest, everHadNegTestM)
<ul>
<li>Response to “Have you ever had a negative HIV test?”</li>
<li>Three possible values: TRUE, FALSE and NA</li>
<li>The second version has a lower number of repeat testers</li>
</ul></li>
<li>Time from last negative test to diagnosis (infPeriod, infPeriodM)
<ul>
<li>If everHadNegTest=FALSE, imputed as the smaller of 18 years, or hdx_age-16.</li>
<li>The second version has a correspondingly different set of imputed cases</li>
</ul></li>
</ol>
<p>The remainder of the variables are optional descriptive variables by which the data can be stratified for subgroup analyses. We will use the second versions of the last test and infPeriod variables to examine the impact of the repeat testing fraction on the estimates of undiagnosed cases (at the end of this vignette).</p>
</div>
</div>
<div id="specify-diagnosed-interval-length" class="section level2">
<h2>Specify Diagnosed Interval Length</h2>
<p>The intervals of the <code>timeDx</code> variable represent the discrete time unit for reporting cases, and determine the finest interval by which we may estimate incidence and undiagnosed counts. In the example data, this interval is a quarter year (0.25). We will store this in an object to use throughout:</p>
<pre class="sourceCode r"><code class="sourceCode r">diagInterval =<span class="st"> </span><span class="fl">0.25</span></code></pre>
<p>This interval maximizes the use of reported information, and defines the unit of analysis for “undiagnosed HIV.” Results will be estimated as undiagnosed counts per quarter. Using quarterly reports implies that a diagnosis made within 3 months of infection is acceptable and contributes no “undiagnosed” time. If we used a longer interval, by re-formatting <code>timeDx</code>, this would modify the meaning of “undiagnosed” accordingly.</p>
</div>
<div id="estimating-the-time-from-infection-to-diagnosis-tid" class="section level2">
<h2>Estimating the Time from Infection to Diagnosis (TID)</h2>
<p>The testing history data provides bounds for the possible infection period or “infPeriod” within which infection must have occurred, for all diagnosed cases that have a prior negative test. If a case is diagnosed on their first test, there will be no prior negative test (<code>KCsim$everHadNegTest=FALSE</code>), and we need an alternative approach to defining the possible infection period. In the paper, these cases were assigned an infperiod that was the minimum of 18 years or age-16.</p>
<p>The next step is to aggregate these individual infection periods and use them to define a population level probability distribution for the time from infection to diagnosis (TID). This will require making some assumption regarding when infection occurred within the possible infection period.</p>
<p>HIVBackCalc implements the assumptions that define the two “cases” for the TID examined in the paper:</p>
<p><strong>Base Case</strong> - The probability of acquiring infection is uniformly distributed across the infection period. This assumes testing is not driven by risk exposure, so is likely to be conservative (i.e., overestimate the time spent undiagnosed).</p>
<p><strong>Upper Bound</strong> - All infections occur immediately after the last negative test. This is an extremely conservative assumption that represents the maximum possible amount of time people could have been infected but undiagnosed.</p>
<p>The <code>estimateTID</code> function will return the probability and cumulative density functions for each of these cases.</p>
<pre class="sourceCode r"><code class="sourceCode r">TIDs &lt;-<span class="st"> </span><span class="kw">estimateTID</span>(KCsim$infPeriod, <span class="dt">intLength=</span>diagInterval)</code></pre>
<p>We can examine the TID for each case by plotting the probability and survivor functions.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(TIDs, <span class="dt">intLength=</span>diagInterval, 
     <span class="dt">cases =</span> <span class="kw">c</span>(<span class="st">'Base Case'</span>, <span class="st">'Upper Bound'</span>))</code></pre>
<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-6" /></p>
<p>The spike in density at 18 years for the <strong>Upper Bound</strong> TID reflects the assumption we made for the cases that were diagnosed at their first test.</p>
<p>We can evaluate the TID at particular time points of interest using the <code>summary</code> function. The time points should be specified in years and represent the left bound of the discrete time between infection and diagnosis.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(TIDs, <span class="dt">intLength=</span>diagInterval,
        <span class="dt">cases =</span> <span class="kw">c</span>(<span class="st">'Base Case'</span>, <span class="st">'Upper Bound'</span>),       
        <span class="dt">times =</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">18</span>))</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">Time</th>
<th align="right">Base Case f(x)</th>
<th align="right">Base Case S(x)</th>
<th align="right">Upper Bound f(x)</th>
<th align="right">Upper Bound S(x)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.00</td>
<td align="right">0.3068</td>
<td align="right">0.6932</td>
<td align="right">0.0874</td>
<td align="right">0.9126</td>
</tr>
<tr class="even">
<td align="right">0.25</td>
<td align="right">0.1609</td>
<td align="right">0.5323</td>
<td align="right">0.1493</td>
<td align="right">0.7633</td>
</tr>
<tr class="odd">
<td align="right">1.00</td>
<td align="right">0.0426</td>
<td align="right">0.3330</td>
<td align="right">0.0540</td>
<td align="right">0.5195</td>
</tr>
<tr class="even">
<td align="right">5.00</td>
<td align="right">0.0049</td>
<td align="right">0.1124</td>
<td align="right">0.0175</td>
<td align="right">0.2248</td>
</tr>
<tr class="odd">
<td align="right">10.00</td>
<td align="right">0.0010</td>
<td align="right">0.0477</td>
<td align="right">0.0032</td>
<td align="right">0.1326</td>
</tr>
<tr class="even">
<td align="right">17.00</td>
<td align="right">0.0000</td>
<td align="right">0.0042</td>
<td align="right">0.0000</td>
<td align="right">0.0755</td>
</tr>
<tr class="odd">
<td align="right">18.00</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
</tr>
</tbody>
</table>
</div>
<div id="backcalculation-of-incidence" class="section level2">
<h2>Backcalculation of Incidence</h2>
<p>To backcalculate incidence, we must define a vector of diagnosis counts per interval. By default, this vector contains 100 empty intervals prior to the first interval in which we observe diagnoses. These empty intervals will indicate to the model how far back to project incidence.</p>
<pre class="sourceCode r"><code class="sourceCode r">diagCounts =<span class="st"> </span><span class="kw">tabulateDiagnoses</span>(KCsim, <span class="dt">intLength=</span>diagInterval)</code></pre>
<p>The backcalculation uses the same diagnosis counts but different TIDs to project incidence for each of the cases.</p>
<pre class="sourceCode r"><code class="sourceCode r">incidenceBase =<span class="st"> </span><span class="kw">estimateIncidence</span>(<span class="dt">y=</span>diagCounts,
                                  <span class="dt">pid=</span>TIDs[[<span class="st">'base_case'</span>]]$pdffxn,
                                  <span class="dt">gamma=</span><span class="fl">0.1</span>,
                                  <span class="dt">verbose=</span><span class="ot">FALSE</span>)
incidenceUpper =<span class="st"> </span><span class="kw">estimateIncidence</span>(<span class="dt">y=</span>diagCounts,
                                  <span class="dt">pid=</span>TIDs[[<span class="st">'upper_bound'</span>]]$pdffxn,
                                  <span class="dt">gamma=</span><span class="fl">0.1</span>,
                                  <span class="dt">verbose=</span><span class="ot">FALSE</span>)</code></pre>
<p>We can plot the backcalculated estimates over time, overlayed by the diagnosis counts in red.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(incidenceBase, <span class="dt">case=</span><span class="st">'Base Case'</span>)
<span class="kw">plot</span>(incidenceUpper, <span class="dt">case=</span><span class="st">'Upper Bound'</span>)</code></pre>
<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-11" alt="plot of chunk unnamed-chunk-11" width="325px" /><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAHgCAMAAABKCk6nAAAAZlBMVEX9/v0AAAAAADkAAGUAOTkAOY8AZrU5AAA5ADk5AGU5j9plAABlADlltbVltf2POQCPOTmPtY+P29qP2/21ZgC1ZmW1/rW1/tq1/v3ajzna/rXa/v39tWX924/9/rX9/tr9/v3/AAAUCIwjAAAAInRSTlP//////////////////////////////////////////wD/s/bRjgAAAAlwSFlzAAAOwwAADsMBx2+oZAAAEglJREFUeJztnY12ozgSRsvd285sMuvsbtiZZsZJyPu/5ALiR4CEJaBUovq753SaGApVuBYSsgxUAdWQdAKAF5JOAPBC0gkAXkg6AcALSScAeCHpBAAvJJ0A4IWkEwC8kHQCgBeSTgDwQtIJAF5IOgHAC0knAHgh6QQALySdAOCFpBMAvJB0AoAXkk4A8ELSCQBeSDoBwAtJJwB4IekEwigvPT/+nq7538/q83Xx6oJ6MwfF5bt5fW0Xk3VDxFkg6QTC8An+ePkeIrjdzAEE54JPcODx9m0WJDhoT9lC0gmEUU6Oa9mbLpqF7382dj5eLtd7/dutWfvtrdns/eliFs1mP83C1eyjaFbNBJftS1101eyt3t0g344YduQOqSZFiULSCYQxEdxV5/qVqWCLZuu7WayPfSe426RZV0sbN6xGwUNI9664XJ67dXaEtSN3iL2FMCSdQBjjKfrWHLxrq++5O2N+9oKfq6EOt16ubS3uNzM/6+2e2+hrK2QuuP69jTb7rzf+/tOssyOsHblD7C2EIekEwrAF186GmjERXGswP43VPu46UWtOBsa4kdEwCL6174k+pCqHPpwVYe/IHWJvIQxJJxCGLbg7WbYKJ4KvVVe7jeD+pNof+rZJNqdTU7sXnayyPdO2+7B6Xe2iHWHtyBNibyEMSScQxqQu9M3tbVVw6/dmXmg3u1+Go25efSC47yJZuzcR1o48IfYWwpB0AmHMT3Z9P3pFsKnGluD6hVsXPnaMI2rwEGHtyF+Db1UekHQCYUwEf/7bdFn7ttQt+N63js9jGzxct/ja4MFWt8W9fsHVBl/HxFwh9hbCkHQCYYxtcFuBzGVLr8Rbg9uK17xQ9pfDt64b5utFj7baLZrwm6sXPezIHWJvIQxJJxCGLbj/pTmyTWM3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" title="plot of chunk unnamed-chunk-11" alt="plot of chunk unnamed-chunk-11" width="325px" /></p>
<p>While the TIDs for the two cases are quite distinct, the incidence estimates are almost identical. This is because the diagnosis counts are relatively stable, and the TIDs are constant, not year-specific (this assumption was tested in the paper). Together, this implies that incidence is approximately equal to diagnosed cases, and both TID cases will conform to this incidence estimate. The impact of the different TID assumptions is just to recalibrate the fraction of prevalent infections that are diagnosed at any point in time. People have been undiagnosed for longer in the upper bound case, so the observed diagnoses in this case are estimated to have a greater fraction of persons whose time of infection was further in the past. This in turn will generate a higher fraction of recently infected persons who are undiagnosed, as we see next.</p>
</div>
<div id="estimation-of-undiagnosed-counts" class="section level2">
<h2>Estimation of Undiagnosed Counts</h2>
<p>Estimating undiagnosed counts requires applying the TID to the incidence estimates to determine how many of those who were ultimately diagnosed were undiagnosed in a given interval.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Base Case</span>
undiagnosedBase &lt;-<span class="st"> </span><span class="kw">estimateUndiagnosed</span>(incidenceBase)
<span class="co"># Upper Bound</span>
undiagnosedUpper &lt;-<span class="st"> </span><span class="kw">estimateUndiagnosed</span>(incidenceUpper)</code></pre>
</div>
<div id="examining-results" class="section level2">
<h2>Examining Results</h2>
<p>The results of the two cases can be combined and contrasted by creating a “results” object using <code>combineResults()</code>. Note that the names of the upper-level list, e.g. “Base Case” and “Upper Bound”, will be used to label the respective results in the results plots and tables that follow.</p>
<pre class="sourceCode r"><code class="sourceCode r">results &lt;-<span class="st"> </span><span class="kw">combineResults</span>(<span class="kw">list</span>(<span class="st">`</span><span class="dt">Base Case</span><span class="st">`</span>=<span class="kw">list</span>(incidenceBase,
                                            undiagnosedBase),
                             <span class="st">`</span><span class="dt">Upper Bound</span><span class="st">`</span>=<span class="kw">list</span>(incidenceUpper,
                                              undiagnosedUpper)))</code></pre>
<p>The estimates are summarized over all time periods in the <code>results$resultsSummary</code> element.</p>
<pre class="sourceCode r"><code class="sourceCode r">results$resultsSummary</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Diagnoses/Case</th>
<th align="left">Estimate</th>
<th align="right">Min.</th>
<th align="right">1st Qu.</th>
<th align="right">Median</th>
<th align="right">Mean</th>
<th align="right">3rd Qu.</th>
<th align="right">Max.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"># Diagnosed</td>
<td align="left">Diagnoses</td>
<td align="right">44.0</td>
<td align="right">49.5</td>
<td align="right">54.5</td>
<td align="right">54.4</td>
<td align="right">59.0</td>
<td align="right">68.0</td>
</tr>
<tr class="even">
<td align="left">Base Case</td>
<td align="left">Incidence</td>
<td align="right">53.2</td>
<td align="right">53.7</td>
<td align="right">55.1</td>
<td align="right">54.9</td>
<td align="right">55.8</td>
<td align="right">56.7</td>
</tr>
<tr class="odd">
<td align="left">Base Case</td>
<td align="left">Undiagnosed Cases</td>
<td align="right">415.0</td>
<td align="right">420.0</td>
<td align="right">428.0</td>
<td align="right">427.0</td>
<td align="right">432.0</td>
<td align="right">441.0</td>
</tr>
<tr class="even">
<td align="left">Upper Bound</td>
<td align="left">Incidence</td>
<td align="right">53.6</td>
<td align="right">54.0</td>
<td align="right">55.9</td>
<td align="right">55.4</td>
<td align="right">56.3</td>
<td align="right">56.9</td>
</tr>
<tr class="odd">
<td align="left">Upper Bound</td>
<td align="left">Undiagnosed Cases</td>
<td align="right">820.0</td>
<td align="right">829.0</td>
<td align="right">842.0</td>
<td align="right">839.0</td>
<td align="right">848.0</td>
<td align="right">858.0</td>
</tr>
</tbody>
</table>
<p>Plotting the results object will panel the incidence and undiagnosed estimates with the cases overlayed:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(results)</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAHgCAMAAAB6sCJ3AAABDlBMVEUAAAAAADoAAFIAAGYAAP8ALnMAOjoAOmYAOpAAUpEAZmYAZrYICAguAAAuAC4uAFIuLnMuc686AAA6ADo6AGY6OgA6OmY6OpA6ZmY6ZrY6kNtSAABSAC5SAFJSLnNSkcxmAABmADpmAGZmOgBmOjpmOpBmZgBmZjpmkJBmtv9zLgBzLi5zr69zr8x/f1p/f21/f3+QOgCQOjqQOmaQkDqQtpCQ27aQ2/+RUgCRzJGRzK+RzMyvcy6vkVKvzK+vzMy2ZgC2Zjq2/7a2///MkVLMr3PMzJHMzK/MzMzbkDrbtmbb25Db27bb2//b/7bb/9vb///l5eXumgD6+vr/tmb/25D/29v//7b//9v///9y9E29AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAY4ElEQVR4nO2dC3vcuHWGx/a4sSqka8tp3U7qWOskbWRHWWvTVnbWm1Urydb0ksrjmUr8/3+kBO8XkAB4QOJg+H3PY2tIDsFvyJcHOAQJLiIIImjh2wAUtgAQRBIAgkgCQBBJAAgiCQBBJAEgiCQABJEEgCCSABBEEgCCSAJAEEkACCIJAEEkASCIJAAEkQSAIJIAEETScIDeQbOTW4CUc78MLi/TV2oBcODKwLubhgDQTBwAIIrgAACRBAcAiCQ4AEAkwQEAIgkOABBJcACASIIDAEQSHAAgkuAAAJEEBwCIJDgAQCTBQSgAfVXpi3LulNpDB8KPAUSgfXEg/BgAQPviAABZiN/h8+8AAFmI3+Hz60Dkmt4AANoPByKyosedAQC0Bw4SdACQhVgdPk8OROOTsGwFOQPo0y8XiR7+AIBCciBqfzw2oj+9TMjJ/oQBkO3Ocu+AB0B2zWbHBgAQRRwAatPjJQsDQEPkFSDRmbZb7Bh3jeiPj3+6ufn85iCgRvTMAZIiVF5uDFSysCvZhn4WShamOvusdyY/gKx/AiOAgkvjJTyiehICIPty5g5Q9iG/BmKp0AES3SuYFuT4OtDDD9RG9HqxOIyi7WJxUpk5CkC1S2bC/hIa3YFvgESfA8OSuEWg3Yvb+7OTu2/Pd7+4LOeaAWR5/OvADOlIpFcgTgGy/gleAGqWW2Zhi8d/fvOKCtB6Jf+XGH1/Xs4dAyBBv5WBGUD1Bp1eot+BWUnOAPr08of3r66f/kQE6OJ3R3EVto1rsYukDkv7R959MZEw+lZvAcQiyA4IW0w/CXMLI5nVFatengD08Vl+GZEA0JPbGJ0SoFSjVGHKCETrSZw+AuVdWXnksWjICScOWhFIt/3OKuz9q6uD62/IAJ3Iasy+CnNS/4vIkgGSg0jhwFrNWzCsM4E+ByZFWQGk2kf1LOwZtQ2Uxp6BjWgn9T+hI0iQD5/t6bvZ1GfF07UZcrq5vHdGfdogJNtGoNZBcn0dKE7jV8PSeGEdQNRnH6EjyLIVqwVIc3jFJlb1fJbT1TKS6Ug1LXRfMHLQdiQSQ6JzBdFCOAPoY5yCFTcDebmQKOzvqHN8FYbuoHX0ug+vPEqbTf0b5tPCbAUtYI3pFGmLFaJ8F3z39vcyhb96TM3C1LIAyCyCuGlAtpPofge6CkRx9NqHN41ym2J6k34eMl3MUU/bEJkFX1uko/wg/OFlcgmanoWpZQBQ9aqynqR+gIZ1BAldvFfUD9UZIgMk2Xp5wPODWy6X00v5bymnl+nn6rRQL9c6aExvKo5MgNtUGK9NF8tFJ0DfvT19LyPQga8qTFg1GIXyC+bLVTNEvYaJtAGlNqMERkT5d7Ljn36uTC+LEpbF8tq06Foe1Sowg99Yc7zMHBTA5tM5sBXLymlR+0mZsjbQ9c+rd0RPAlDP4WtPR7WdIRrTzeVG0+oAUjdQTLfPxnqEqQESn/J5BFnmwMgw0OIhWlpOl78+l6Yab6R5dQdCyOlam7kD6WK77Z/grTdec373nu/CYAWrAqONaAFSm47qAUUZUUS5d9ODslxmAORHqM3DgL7MegWtawc2MnktoekMofqCUK7Q6I2fLAI1jucmm84PWLVB0aqvhUF9LjTLtYCIdDqPJmVAKaugxvlc37spQVHlKnOkaJ11ANTZimtd2TEAaMhyxeyOb9Yi0IRtoCowoqdBmU836u/ItH7vnG7X901AkvhesVwElMqc3p8tlLe819QVgbpv82ksoWai3RsyVA2gKbOweoWkrn1Fc0ajhKhvuW66Xb83AZGTffFf05Fg0jdiD5CFA11xvVduTQmqAUTvC1NL34iO1NWzUH2hmPm1vYLNdGWGUH9B1LfXVuHAvCaoq7MNZFqgYQRSFSd6DdRX6f4hjvvC1Bp2R2LHCVLOsj3/TVsgzRVEY7rU164FmvkGDtqrKkPaNEPcac8hn/dEW/ZfVmSWgfTcdG+eA3XEImoT1gqgSNXNwmeMRBmCfPSFDefH+PB13nRvgbC6q/erZnUCQIYFGgMk1JO9Bkx2TA7QZ199YVqTHb88sjr/hSKBsURYdbNHbzPURDYAdSNsvHrxuZjQAtS6cKA0kD3aPFoW1j1AqMGooqJzwmLFogHRcmBYpLIAYT8sal19g6TWS043TNmaUHzSj9IqjLbpLQJZn77VFWzr/1YI+dIsUb9xUbsyOOBRIoWD7q11TFRksw9E1A5j2hCou7vFcxvIdv+TMpBWNB4AUPah9VTsQJlWYZ3bsdoHiupIm4gaAzR9FjboyFXnDgCofshtEa7HhCE3UTdldCGhbwtD9oGxAZOfWAB09fBPbxbk58LUIgPUuiKTaNjOq5RBzoGoAUjjQOhb6db7QFWL93voV5GFvT29/ubDr6ZsA1mdu6o96X1wlbEBMthFVm0gRUBxBpB8Luxg2jsS7fa+ov4eDFDlIggNgfEBMjt+5rJtA9lEoPfP6E+mqtUubUADot2zPTwCFTUikYBRATLaR2wAurmKc7D3bNtAyhVIVRj5GiDZgZRhb5w7B9YAmRngnoWpT0fa4dNdYjURAPJ5HchvBDJpYGgVHkC2BrSq9IVdHUx7JdpzFebiMg4AqmZhVxNnYY6GpiGIfwQa3YG7CPT2dOoIBID2CaCb66c/en02foAAECeAvN2ROFwAiBNAzvrC1gOHd7FX+IfPvwOXbSA3fWG7o1U0bIApa4V/+Pw7cJmFOekLu//+n1eVUVptBtmEwpW7vrD1Kq7Chg2yaa3wz3//Dhy2gZz0hcWxBwCF5IBbFraWNdaAUVoHKfzD598BN4CiJAtDIzoYBzwBQhofjAOGACkEgNg6cAeQm5etqAWA2DpweR3IxctW1AJAbB04vZDo4GUragEgtg7cVWFuXraiFgBi68BdBOI3wJRW4R8+/w6QhVEEB64j0JQDjfvfeXDgOgL5e9XBIIV/+Pw7cAsQsrDZOXALELKw2TlAFkYRHCALIwkOHAL0ecxXXioHZtSO7zi64MCVAY/D/BIU/vnv34HLvjBkYTN04LIvDNeBZujAcRZWNIMA0EwcIAujCA4AEElwAIBIggMARBIcoBFNEhwgApEEBwCIJDjAHYkkwQHuSCQJDnBHIklwgDsSSYIDdnck3p8tFocYnSMcB9yysPVhzNAJxgcKxoE7gNy9bGWNEcrCceAMIHd3JN69vizHSMQorfOQwzsS4+oLg2yG48BdBHp7Kt+XQY5Au+fnUYQqLBgH7tpA139z+pk+QlnadkYjOhgH3LKwi2SYX6TxwThw3Rf24SVu55iVA24RSC0AxNZBIE+mKud633lwwPI6kEIAiK0DPJlKERzgyVSS4AA31ZMEB8jCSIIDlr3xbQEgtg5cZmFXB8jCZufAZRZ25eKlu0oBILYOXPbGIwLN0IHD3vinP6INND8HyMIogoNQnkwdc4BQguDA3SitiXAlenYO8GQqRXCAJ1NJggN2T6aqBYDYOkAWRhEcoC+MJDjAHYkkwQHuSCQJDvg9maoUAGLrgNuTqWoBILYOkIVRBAfIwkiCA9yRSBIc4I5EkuAAdySSBAdc70jE8C6hOOCZhWGAqWAc8ASoHOIOg2zOQ44BwiCbwTjgGYEAUDAOfAO0fXS5Xjw4b8zFKK3BOPAMkHytwfHJ9sltfTYa0cE48AxQTEocg2qwJEIaH4oD/xFo/eR23YxATQEgtg68t4HiBlAyOH2vABBbB74BMhMAYusAAFEEB74Bkq/myV+Q0SMAxNaBV4B2R2lPxQKN6GAdsIhAWgEgtg7QBqIIDrwDtE2qsEdoA4XqwHcVdnzSntkWAGLrwDdAaAMF7sB3FbY+NNkIAGLrwHcEOkYbKGwHviOQmd5Bs5NTgCAoolRhEBT1RKALo1wemrs6AdJ2pkJQ1APQVpuFQbOTGUBZG0hXhSGNZ+sgkDReOdf7zoMDAEQTHHgH6P7M4H4yAMTXgffHemRf2AXuSAzWge++MNwTHbgDRCCK4MA3QGgDhe7AN0BmAkBsHQAgiuDAM0Br2YexbQ0P1BIAYuvAK0DrtA9sd7TSbAQAsXXgE6DijvrWAFNNASC2DlgAhOtA4TrwCdD9WVZ1YYCpcB14HlwhIWitbUUDIEcONhvdjJENtEVL4y/k3UD6R8PefVXpi3LulArNwSZW/wxbaVdvfqFjBVwHGsVBMz5oA0j/9CZR3wxtRGosb66u/UJ7BVxIJIi693VfUPMiZ6X/Nk2CFFvo26AKwN4vtFcICSDt+WythgPL09fweHdOa79QmS6BUTuoAmXqqArgRvGFTWV605gu5Q8gu/BtdD5b2tLFc4N40XX8N5XpTe/0xmi66yeqHJVAGAFTrt0Apus31x14A0hnzeZwKVewJdLq9NUBYvSTrPeBQvVqvAFEPzDpjKgxbbkTvQGk46Ex3dwZ7Z2jBaqXSMXZp1s+ICYSG9EqNdqBlkG13Y6wDuOeATIN55HmcOmBqk/rwrVJOB9yvJuaOg8cy0AAVZj2cFlGLPs2j+JoeM8Dw74SbSwnjei27MK3nkidQ60DewEgI/m5DqTnxfvh8+8AAFEEBwCIJDgAQCTBAQAiCQ4AEElwwAigtbw1aCXvEHp0iXemBuOAD0BRcm90+rZvvLU5GAfuAPr8Jhls7OEPwwG6OMnury/fG5++T+zdF2i/FQP0/oAagWJsou1fHS0Oo+1hfehWRCC2DpxFoE//eEoF6ELeYv9/t9H6BAAF48AdQC9/IAJ09zpr9axXZRWWCgCxdcAoAskaLKm81idoRAfjwF0jmtwG2iaP91zIXB5pfDAOWGVhnQJAbB2wug7UKQDE1oG7NtAvK/EHAM3GgdsIdHWACDQzB24BKnN5ADQTB24Buv4GAM3MgeM20DNUYTNzgCyMIjhwfB2oSMIA0FwcOAPo85tXcRb2+CcANC8HbjtTkYXNzoHDvrBXuA40QweOszD0hc3NQSBZmHJgxtCGuNxLB44MFH1hH14iAs3KQSARSDnX+86DA5cAfVw8/rNM5QHQrBy4TOPfv7p+iutAM3PgEqCPz3AdaHYOXF4HujpAb/zsHKA3niI4QBZGEhw4A+hjnIKhN36GDhwZ+O7t79EbP0sHjgz84eUH9MbP0oGzCHSK3vhZOnDVBrr++QLPhc3RAbIwiuAAT6aSBAecnkytDq+J0TlCccDnydTq8JoYHygYB3yeTK0Or4kRyoJxwKcvrDq8ZjlGIkZpnYdcZGGV4TUxyGYwDtxVYTIEUfvC8uE1UYUF44DPk6nV4TXRiA7GAaMnU6vDayKND8UBnwjUJwA0loPl0rMBt22gLgEgRw6avCyXjTm2QGm/395i4wsB94WRzz7nAOn2dsux5QpNXpbLxhwtUJoCjbZYX6EA6Orhn94spnwujLq3yWdfCyBdAbaOtHvfcoUGL8tsxjL5rPiCbYH6L7RXKNtAb0+vv/nwq+naQNS9TT77rIm0daTd+5Yr5LiUwNQd6IGqT7e/X//CsjK9bEyXqj4XdjDhHYnEvU0/+6yJ7HW0rEwvraaXxtO2NU5zH3UAU/l+1FxuUYXFEej9swmfTLXcefofrwOqn0jFzutd3gSi7chgesgKUUP9rTDrAg2+oDQg20BxDvZ+wjYQeW+Tzj7d2WZyNtrvbV0lql+hJU0eqC2wmUdYNyT9ZWHkvU0/+6zbPDpH1vJ+IQHXgbplT6Tl8n24EuXySvTVAa5Ez86By76wqymzsIjBzoMDlxHo7Ski0AwduGsDXT/9cbw20JjjOxIEB+4G2QywL2wPzn//DtxFILwrY5YOcD8QRXDA6Y7EHgEgtg5cjpGI0Tlm6MDxc2F4V8bcHGB0DorgAACRBAcAiCQ4AEAkwYFLgK5kG/oVAJqXA3cAfZQXET+/eQaAZuXA7YXEm5tP2XMZAGgmDpwDhDcWzsuBwyvRyVXojweowmblwGEjWhJU9KYOGCPxbLE4rA+1WQgAsXXAJ41fH8YMnVSH2iyXASC2DvgAJLVeVYfaLOcDILYOHKbx9Jfu3r2+rA61mayDQTZnIScv3Y0rrtpQm+USRCC2Dlym8cSX7u6eZ5VWPtRmuQgAsXXg8oYy2kt309ZPdajNchkAYuuAz0DjF3L9VW2ozUIAiK0DXllYlwAQWwfuAJp8iDv/Ow8O3D7aPO0Qdwx2Hhw4zsIwuML8HLiMQJMOcRcx2Hlw4LQNNPEQdwx2HhwgC6MJDhwCtH9D3OkFB04HV8AAUzN04DILwxB3M3TgMgtDBJqhA3dtoFGHuFPO9b7z4ABZGE1wEEpf2JjjOxIEB+4G2URf2DwdoC+MIjhAXxhJcIC+MJLgAFkYSXAAgEiCAwBEEhwAIJLgAACRBAcAiCQ4AEAkwQEAIgkOABBJcACASIIDAEQSHHAFCKNzhOKAJ0AYHygYBzwBwghlwTjgCRAG2ZybRgMoFSIQWwc8IxCqsGAc8AQIjehgHPAECGl8MA6YAtQQAGLrAABRBAcAiCQ4AEAkwQEAIgkOABBJcACASIIDAEQSHAAgkuAAAJEEBwCIJDgAQCTBAQAiCQ5CAWjM8R0JggN3g2yOC5BSC/XsCQUH4xlwCpBarsuDA+YGANAeOgBAcBCMAQC0hw4AEBwEY8D7j4XCFgCCSAJAEEkACCLJPUC75+fbxeLRpf6bY2l39ODfjr062CbDTzw4139zJO2OFodRdPd6/H3gHKD77893L27lk/SuSzZ28MfLu2/Po7vf+nNwljzC628fSAPbR5dBAhSb3v3DNPB3O5Bb9+ug8seXgbvX/xEiQNG/n8tBPCREnpRFIJ8xMItAv/AFUDqMyt1vJjDgHqD7M1n/P/F29GQLxHcbKG6C+G4DSYS3E+wDZGEQSe4B8p6BMHAwI7nPwnxnIAwczEljZGGVPz7EwMFxOg6pt2bYhAZGi0DeMhAGDuRwgN62PbGBEa5E+85AGDiItj6z0EkNIAuDSEIWtpcOpjOALGwfHUxoAFnYPjqY0ACysH10MKEBZGF76WA6A8jCIJJGiUAT3QwHBwwMjNIGmuhmODhgYGCcLGyam+HggIGBMe6Jjia6GQ4OGBgYow001c1wcMDAALIwiCQABJEEgCCSABBEEgCCSAJAEEkACCIJAHUr7dJePPhXj7fnsxcA6pXPRzvCEADqFQDSCQD1KgEo/u/+7HdHi8PsJgm/AzcwEwDqVQnQk9u74ye3u+fn8laJte/HvvgIAPWqBOgkyv7JWd6fPOUjANQrFUBHvh97ZSUA1KuOCAQVAkC9UgAk/wCiQgCoVwqAZBaGGqwQAIJIAkAQSQAIIgkAQSQBIIgkAASRBIAgkgAQRBIAgkgCQBBJAAgiCQBBJAEgiCQABJEEgCCSABBEEgCCSAJAEEkACCIJAEEkASCIJAAEkQSAIJKCAuimQ+zKHcsoQ4UFkNVsj+WOZZShANAY5QIgngJA/ASAxigXAPEUAOInADRGuQCIpyoHQKhnk8s1mO2jQL4CQPUClksX5VbW3GxcFMhX+wLQ3evLi+QlfekAhrsXhsOoyhGjKuUulxWCbrLB6k861+1aVha42VQIkgXGxvrM9W0w8cpN+wLQ7sX//lEOO7c9tBsdvA7QclklKDveXUOy3p+tupYVBW42VYJMAOrdIACi6SYSMTiiUJRMx7PvjuVLLeTgzRKg6OIkPg7rhRwVfLt49C8nu78/lp/jOaskbKySSJXM+dmvU4AkNcsMoPRzCdBvb6OksNqq6bLov/9HtSxeU1KzyQBKP1cB2v3dr+Mvpv+nK8Wf5fDllQ2u5MT99+eF+8QrNwUGUKFmBFqvEnRSgNar3Yv/enEbV2vxyXx3LAdWjT/L/789j78gP8fH6ULOT95Oq6nCDuWRjFeqrppvKlIu01Zh6YDl2f+pl+dJ2Mk3mHjNAMrdp2/SZaY9ASjez+uV/FwAdBsfigfn2cFJDoRcdHGSvq5ANpUWK7lK/Xg3G9F5jZIWVlk1KgBSLetuROcAxX8Sl5L8ZKWsXss2mHlNAUr+z71y034ApKjC/vNRdg43AEoO+El68BUANTaXHNaLk21SWHXVKMqbMqpl/QU2ATqslJZvMAeoiEMAyIG6I9DuxV9eJy3nrBEdA3QYbR+cZ1VYURV8e76Wh2aVVR7xnGMtQGkFFRdWXTXKGtHHK9Wy7gIla/F3a1VYUZFFxQazKiz+Ic8rFdkxAKKp+7hs8yqgSOP/crz463iHx43of8oAkg3T+AhcJKEqb0Q/+Nt+gNKs+i4trLpqlLy2Z7FSLuu5kLhNvqdoRGcAZWl87vVnvzkv3CdeuWlPAOqR3PljlEsqMMXF+GoVY+05QGmQcF8utUAA5EXoTOUnADRGuQCIpwAQPwGgMcoFQDyFx3r4KSiAIH4CQBBJAAgiCQBBJAEgiCQABJEEgCCSABBEEgCCSAJAEEkACCIJAEEkASCIJAAEkQSAIJIAEEQSAIJIAkAQSQAIIgkAQSQBIIgkAASRBIAgkgAQRBIAgkgCQBBJAAgiCQBBJP0/uKuwRyyoDSMAAAAASUVORK5CYII=" title="plot of chunk unnamed-chunk-16" alt="plot of chunk unnamed-chunk-16" style="display: block; margin: auto;" /></p>
</div>
<div id="direct-calculation-assuming-constant-incidence" class="section level2">
<h2>Direct Calculation Assuming Constant Incidence</h2>
<p>This simpler method may be used if both HIV incidence and the TID probability distribution are constant over time.</p>
<p>We first define incidence as the average of observed diagnoses (per quarter):</p>
<pre class="sourceCode r"><code class="sourceCode r">constantIncidence &lt;-<span class="st"> </span><span class="kw">mean</span>(diagCounts, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre>
<p>We can then apply the TID to estimate undiaagnosed counts assuming this constant incidence:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Base Case</span>
undiagnosedConstBase &lt;-<span class="st"> </span><span class="kw">estimateUndiagnosedConst</span>(<span class="dt">infPeriod=</span>KCsim$infPeriod,
                                                 <span class="dt">case=</span><span class="st">'base_case'</span>,
                                                 <span class="dt">intLength=</span>diagInterval,
                                                 <span class="dt">incidence=</span>constantIncidence)

<span class="co"># Upper Bound</span>
undiagnosedConstUpper &lt;-<span class="st"> </span><span class="kw">estimateUndiagnosedConst</span>(<span class="dt">infPeriod=</span>KCsim$infPeriod,
                                                  <span class="dt">case=</span><span class="st">'upper_bound'</span>,
                                                  <span class="dt">intLength=</span>diagInterval,
                                                  <span class="dt">incidence=</span>constantIncidence)


<span class="kw">rbind</span>(<span class="dt">BaseCase=</span>undiagnosedConstBase, 
      <span class="dt">UpperBound=</span>undiagnosedConstUpper)</code></pre>
<pre><code>##             [,1]
## BaseCase   430.8
## UpperBound 850.1</code></pre>
</div>
<div id="impact-of-repeat-tester-fraction-on-estimates" class="section level2">
<h2>Impact of Repeat Tester Fraction on Estimates</h2>
<p>In the Seattle/King County jurisdiction, repeat testing among MSM was the norm: over 90% of those with known testing history reported a previous negative test, and the median inter-test interval was just over a year. Our methods perform well in this setting, as the uncertainty is well bounded in the observed data.</p>
<p>In other jurisdictions, repeat testing may be less common, with more people diagnosed on their first test. In this case, the length of the period during which infection may have occurred is not bounded by an observed inter-test interval, it must be imputed, and that requires an assumption.</p>
<p>Our method takes a relatively conservative approach to this imputation, assuming the window of possible infection is the shorter of 18 years, or age-16. The base case estimates assume the probability of infection is uniformly distributed across this interval; the upper bound assumes infection occurs at the beginning. In both cases, this introduces a potentially long period of undiagnosed infection.</p>
<p>To get a sense of how this would affect the estimates of the number of undiagnosed cases, we will analyze the simulated dataset with 50% of the repeat testers randomly recoded to have no previous test. The recoded data are the variables “everHadNegTestM” and “infPeriodM”.</p>
<p>We’ll run the estimates with the constant incidence assumption, and compare the results.</p>
<p>First, compare the data, before and after the random last negative test deletions:</p>
<pre><code>## Comparing whether last negative test exists</code></pre>
<pre><code>##        FALSE TRUE &lt;NA&gt;
## before   166 1113  243
## after    633  646  243</code></pre>
<pre><code>## Comparing length of possible infection window (years)</code></pre>
<pre><code>##          0   1   2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17  18 &lt;NA&gt;
## before 318 353 134 98 49 59 34 17 17 12 23 10 12  3 15  6 13 11  95  243
## after  174 214  90 54 26 50 38 35 30 32 30 21 26 22 23 26 32 32 324  243</code></pre>
<p>Roughly half of the non-missing cases are now diagnosed on their first test, and the distribution of the possible infection window is strongly shifted to the right.</p>
<pre class="sourceCode r"><code class="sourceCode r">constantIncidence &lt;-<span class="st"> </span><span class="kw">mean</span>(diagCounts, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)
 
<span class="co"># Base Case</span>
undiagnosedConstBaseM &lt;-<span class="st"> </span><span class="kw">estimateUndiagnosedConst</span>(<span class="dt">infPeriod=</span>KCsim$infPeriodM,
                                                 <span class="dt">case=</span><span class="st">'base_case'</span>,
                                                 <span class="dt">intLength=</span>diagInterval,
                                                 <span class="dt">incidence=</span>constantIncidence)

<span class="co"># Upper Bound</span>
undiagnosedConstUpperM &lt;-<span class="st"> </span><span class="kw">estimateUndiagnosedConst</span>(<span class="dt">infPeriod=</span>KCsim$infPeriodM,
                                                  <span class="dt">case=</span><span class="st">'upper_bound'</span>,
                                                  <span class="dt">intLength=</span>diagInterval,
                                                  <span class="dt">incidence=</span>constantIncidence)</code></pre>
<pre><code>## Compare resulting estimates of the number of undiagnosed cases</code></pre>
<pre><code>##        BaseCase UpperBound
## before    431.0      850.0
## after     932.0     1830.0
## ratio       2.2        2.2</code></pre>
<p>The estimate of the number of undiagnosed cases is roughly doubled, for both the base case and the upper bound assumptions. This will also double the estimate of the undiagnosed fraction, because the number of cases is still small relative to the estimated number of persons living with HIV in this setting. Thus, with an increase from 9% to 50% of the diagnoses coming from first-time testers, our estimates of the undiagnosed fraction would increase from the 6-11% range we report in the paper to something on the order of 12-22%.</p>
<p>Of course, many other assumptions could be made about the differences between repeat testers and those diagnosed on their first test. Some of these could lead to different results. For example, if the repeat testers are coming in on a regular annual schedule, while the first-time testers are testing in response to a recent risk exposure, then we would expect little impact on the estimates, or perhaps a small reduction in the undiagnosed fraction. On the other hand, the Upper Bound estimate for the recoded data does give the worst case that is still consistent with the data.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
